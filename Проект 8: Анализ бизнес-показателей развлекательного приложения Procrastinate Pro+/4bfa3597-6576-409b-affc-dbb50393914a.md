<div style="background:#e5e5e5; color:#000; padding:10px">

–ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑!\
–í—Å–µ –∑–∞–º–µ—á–∞–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Ç, —Ç—ã –º–æ–ª–æ–¥–µ—Ü!

–ù–µ–º–Ω–æ–≥–æ –ø—Ä–æ —Å—É—Ç—å –∏–∑—É—á–∞–µ–º—ã—Ö –Ω–∞–º–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤. –û—Å–Ω–æ–≤–∞ —ç—Ç–æ –∫–æ–≥–æ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑: –ö–∞–∂–¥—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Ç–µ—Ö, –∫—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —Ç–µ—Ö –∫—Ç–æ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –µ–≥–æ —Ä–∞–Ω–µ–µ - –≤—á–µ—Ä–∞, –Ω–µ–¥–µ–ª—é –Ω–∞–∑–∞–¥, –º–µ—Å—è—Ü –Ω–∞–∑–∞–¥ –∏ —Ç.–¥. –í—ã–≤–æ–¥—ã –ø–æ –≤—Å–µ–π —ç—Ç–æ–π –∫—É—á–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Ä–µ–∞–ª—å–Ω–æ! –ò–¥–µ—è –∫–æ–≥–æ—Ä—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º, –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —ç—Ç–∏—Ö –≥—Ä—É–ø–ø –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –û–±—ã—á–Ω–æ –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–æ–≥–æ—Ä—Ç—ã) –≤—ã–¥–µ–ª—è—é—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–¥–µ–ª–∏, –¥–≤—É—Ö –Ω–µ–¥–µ–ª—å, –º–µ—Å—è—Ü–∞ - –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –í—ã–¥–µ–ª–∏–≤ —Ç–∞–∫–∏–µ –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–æ–≥–æ—Ä—Ç—ã) –º–æ–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –Ω–∏–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∏–∑–º–µ—Ä—è—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–≥–æ—Ä—Ç—ã.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–≥–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–Ω–æ –Ω–∞–≥–ª—è–¥–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç—Ç–∏–º –ø–µ—Ä–∏–æ–¥–∞–º –≤—Ä–µ–º–µ–Ω–∏ –º–µ—Ç—Ä–∏–∫–∏.

–í–æ—Ç —Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–π: 
    
https://blog.ohmystats.com/cohort-analysis/
    
https://gopractice.ru/cohort_analysis/
    
https://smysl.io/blog/pandas-cohorts/

–ñ–µ–ª–∞—é —Ç–µ–±–µ —É—Å–ø–µ—Ö–æ–≤ –≤–æ –≤—Å–µ—Ö –±—É–¥—É—â–∏—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏—è—Ö! üôÇ
</div>

<div style="background:#e5e5e5; color:#000; padding:10px">

–ü—Ä–∏–≤–µ—Ç!\
    –¢—ã –æ—Ç–ª–∏—á–Ω–æ –ø–æ—Ä–∞–±–æ—Ç–∞–ª–∞, –ù–û –æ—Å—Ç–∞–ª–∞—Å—å –µ—â–µ –ø–∞—Ä–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–º–µ—á–∞–Ω–∏–π:
- —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –æ—à–∏–±–∫—É NameError.
- –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ "organic" –ø—Ä–∏–≤–µ—Å—Ç–∏ –≤—ã–≤–æ–¥—ã –ø–æ –∞–Ω–∞–ª–∏–∑—É –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏.

–ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –≤—ã—Å—ã–ª–∞–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Ä–µ–≤—å—é! üôÇ
</div>


<div style="border:solid black 2px; padding: 20px">
–í–µ—Ä–æ–Ω–∏–∫–∞, –ø—Ä–∏–≤–µ—Ç!

–ú–µ–Ω—è –∑–æ–≤—É—Ç –°–µ—Ä–≥–µ–π –ö—É–ª–µ—à–∏–Ω, –∏ —è –±—É–¥—É –¥–µ–ª–∞—Ç—å —Ä–µ–≤—å—é —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –î–∞–≤–∞–π –±—É–¥–µ–º –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª. –ù–æ –µ—Å–ª–∏ —Ç–µ–±–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ –Ω–∞ ¬´–≤—ã¬ª, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–æ–±—â–∏ –º–Ω–µ –æ–± —ç—Ç–æ–º. –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - –Ω–µ —É–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ–π –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö.
    
–°–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —è –±—É–¥—É –≤—ã–¥–µ–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –¢–∞–∫ –≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –ø—Ä–µ–∂–¥–µ —á–µ–º —è —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç.
</div>
    
    
<div class="alert alert-warning">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ö†Ô∏è –¢–∞–∫ –æ—Ç–º–µ—á–µ–Ω—ã –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫ –¥–æ—Ä–∞–±–æ—Ç–∫–µ –º–æ–º–µ–Ω—Ç—ã. M–æ–∂–µ—à—å —É—á–µ—Å—Ç—å –∏—Ö –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ù–∞ —Ç–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ.
</div>
    
    
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –ê —Ç–∞–∫ —É–¥–∞—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ–¥—Ö–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
</div>
    
    
<div style="border:solid black 2px; padding: 20px">
  
    
  <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫</b>
    
  üìÉ –¢–∞–∫–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –±—É–¥–µ—Ç –≤ –∫–æ–Ω—Ü–µ —Ç–µ—Ç—Ä–∞–¥–∫–∏. –í –Ω–µ–º –±—É–¥—É—Ç –µ—â–µ —Ä–∞–∑ —É–∫–∞–∑–∞–Ω—ã –Ω—é–∞–Ω—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
</div>

–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ —Ñ–æ—Ä–º–µ –¥–∏–∞–ª–æ–≥–∞: –µ—Å–ª–∏ —Ç—ã <b>—á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å</b> –≤ —Ä–∞–±–æ—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî <b>–Ω–∞–ø–∏—à–∏ –æ–± —ç—Ç–æ–º</b> –≤ —è—á–µ–π–∫–µ `Markdown` –∏ –ø–æ–º–µ—á–∞–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫–∞–∫–∏–º-—Ç–æ –∑–∞–º–µ—Ç–Ω—ã–º —Ü–≤–µ—Ç–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫:
    
    
```
<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.
</div>
```
    
<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.
</div>
    
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <b>–Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</b>. –¢–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ.

<div style="background:#e5e5e5; color:#000; padding:10px">
    <b>–û–±—â–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–µ–∫—Ç–µ</b>
    
–¢—ã –≤–µ—Ä–Ω–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∞—Å—å –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö —É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å–∞. –í–∏–¥–Ω–æ, —á—Ç–æ —Ç—ã —É–º–µ–µ—à—å –ø–∏—Å–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, —ç—Ç–æ –∑–¥–æ—Ä–æ–≤–æ –æ–±–ª–µ–≥—á–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∞–Ω–∞–ª–∏—Ç–∏–∫–∞. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç —Ç–≤–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∏.
</div>

# –ê–Ω–∞–ª–∏–∑ –±–∏–∑–Ω–µ—Å-–ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+

<div class="alert alert-danger">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –ö–∞–∂–¥—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –≤–≤–µ–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, —Ü–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏, –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–ª–∞–Ω (–¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é) –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ç.–¥. –î–æ–±–∞–≤—å –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.
</div>


<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚úîÔ∏è –û—Ç–ª–∏—á–Ω–æ!
</div>

**–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**
–¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Procrastinate Pro+. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–≥—Ä–æ–º–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∫–ª–∞–º—É, –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤ –∫–æ–º–ø–∞–Ω–∏—è —Ç–µ—Ä–ø–∏—Ç —É–±—ã—Ç–∫–∏. –ù—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö –∏ –ø–æ–º–æ—á—å –∫–æ–º–ø–∞–Ω–∏–∏ –≤—ã–π—Ç–∏ –≤ –ø–ª—é—Å.

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
–ï—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö —Å 1 –º–∞—è –ø–æ 27 –æ–∫—Ç—è–±—Ä—è 2019 –≥–æ–¥–∞:
- –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ–± –∏—Ö –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö,
- –≤—ã–≥—Ä—É–∑–∫–∞ –∏—Ö –ø–æ–∫—É–ø–æ–∫ –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥,
- —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.

**–ó–∞–¥–∞—á–∏**
–¢—Ä–µ–±—É–µ—Ç—Å—è –∏–∑—É—á–∏—Ç—å:
- –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫–∞–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –æ–Ω–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è,
- —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤;
- —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –ø—Ä–∏–Ω–æ—Å–∏—Ç –∫–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç,
- –∫–æ–≥–¥–∞ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –æ–∫—É–ø–∞—é—Ç—Å—è,
- –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–µ—à–∞—é—Ç –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–æ–≤.

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Ö –∫ –∞–Ω–∞–ª–∏–∑—É


```python
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
from matplotlib import pyplot as plt
```


```python
# –∑–∞–≥—Ä—É–∑–∏–º –¥–∞–Ω–Ω—ã–µ –æ –≤–∏–∑–∏—Ç–∞—Ö, –∑–∞–∫–∞–∑–∞—Ö –∏ —Ä–∞—Å—Ö–æ–¥–∞—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
visits, orders, costs = (
    pd.read_csv('/datasets/visits_info_short.csv'), 
    pd.read_csv('/datasets/orders_info_short.csv'),
    pd.read_csv('/datasets/costs_info_short.csv'),
)

events = None # –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π –Ω–µ—Ç
```


```python
visits.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>User Id</th>
      <th>Region</th>
      <th>Device</th>
      <th>Channel</th>
      <th>Session Start</th>
      <th>Session End</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>981449118918</td>
      <td>United States</td>
      <td>iPhone</td>
      <td>organic</td>
      <td>2019-05-01 02:36:01</td>
      <td>2019-05-01 02:45:01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>278965908054</td>
      <td>United States</td>
      <td>iPhone</td>
      <td>organic</td>
      <td>2019-05-01 04:46:31</td>
      <td>2019-05-01 04:47:35</td>
    </tr>
    <tr>
      <th>2</th>
      <td>590706206550</td>
      <td>United States</td>
      <td>Mac</td>
      <td>organic</td>
      <td>2019-05-01 14:09:25</td>
      <td>2019-05-01 15:32:08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>326433527971</td>
      <td>United States</td>
      <td>Android</td>
      <td>TipTop</td>
      <td>2019-05-01 00:29:59</td>
      <td>2019-05-01 00:54:25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>349773784594</td>
      <td>United States</td>
      <td>Mac</td>
      <td>organic</td>
      <td>2019-05-01 03:33:35</td>
      <td>2019-05-01 03:57:40</td>
    </tr>
  </tbody>
</table>
</div>



–î–∞—Ç–∞—Å–µ—Ç visits —Ö—Ä–∞–Ω–∏—Ç –ª–æ–≥ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ —Å–ª–µ–¥—É—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö —Å–∞–π—Ç–∞:
- User Id ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- Region ‚Äî —Å—Ç—Ä–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- Device ‚Äî —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- Channel ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞;
- Session Start ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–µ—Å—Å–∏–∏;
- Session End ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏.


```python
# —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤:
visits.columns = visits.columns.str.lower()
visits.rename(columns = {'user id':'user_id'}, inplace=True)
visits.rename(columns = {'session start':'session_start'}, inplace=True)
visits.rename(columns = {'session end':'session_end'}, inplace=True)
```


```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
visits.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 309901 entries, 0 to 309900
    Data columns (total 6 columns):
     #   Column         Non-Null Count   Dtype 
    ---  ------         --------------   ----- 
     0   user_id        309901 non-null  int64 
     1   region         309901 non-null  object
     2   device         309901 non-null  object
     3   channel        309901 non-null  object
     4   session_start  309901 non-null  object
     5   session_end    309901 non-null  object
    dtypes: int64(1), object(5)
    memory usage: 14.2+ MB



```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:
visits.duplicated().sum()
```




    0




```python
# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏:
visits['session_start'] = pd.to_datetime(visits['session_start'])
visits['session_end'] = pd.to_datetime(visits['session_end'])
```

<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∏ –ø–æ–º–µ–Ω—è–ª–∞.
</div>


```python
orders.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>User Id</th>
      <th>Event Dt</th>
      <th>Revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>188246423999</td>
      <td>2019-05-01 23:09:52</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>174361394180</td>
      <td>2019-05-01 12:24:04</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>529610067795</td>
      <td>2019-05-01 11:34:04</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>319939546352</td>
      <td>2019-05-01 15:34:40</td>
      <td>4.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>366000285810</td>
      <td>2019-05-01 13:59:51</td>
      <td>4.99</td>
    </tr>
  </tbody>
</table>
</div>



–î–∞—Ç–∞—Å–µ—Ç orders —Ö—Ä–∞–Ω–∏—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∫—É–ø–∫–∞—Ö:
- User Id ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- Event Dt ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–∫—É–ø–∫–∏;
- Revenue ‚Äî —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞.


```python
# —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤:
orders.columns = orders.columns.str.lower()
orders.rename(columns = {'user id':'user_id'}, inplace=True)
orders.rename(columns = {'event dt':'event_dt'}, inplace=True)
```


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:
orders.duplicated().sum()
```




    0




```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
orders.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 40212 entries, 0 to 40211
    Data columns (total 3 columns):
     #   Column    Non-Null Count  Dtype  
    ---  ------    --------------  -----  
     0   user_id   40212 non-null  int64  
     1   event_dt  40212 non-null  object 
     2   revenue   40212 non-null  float64
    dtypes: float64(1), int64(1), object(1)
    memory usage: 942.6+ KB



```python
# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏:
orders['event_dt'] = pd.to_datetime(orders['event_dt'])
```


```python
costs.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>Channel</th>
      <th>costs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-05-01</td>
      <td>FaceBoom</td>
      <td>113.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-05-02</td>
      <td>FaceBoom</td>
      <td>78.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-05-03</td>
      <td>FaceBoom</td>
      <td>85.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-05-04</td>
      <td>FaceBoom</td>
      <td>136.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-05-05</td>
      <td>FaceBoom</td>
      <td>122.1</td>
    </tr>
  </tbody>
</table>
</div>



–î–∞—Ç–∞—Å–µ—Ç costs —Ö—Ä–∞–Ω–∏—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö –Ω–∞ —Ä–µ–∫–ª–∞–º—É:
- Channel ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞;
- dt ‚Äî –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏;
- Costs ‚Äî —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —ç—Ç—É –∫–∞–º–ø–∞–Ω–∏—é.


```python
# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã:
costs.duplicated().sum()
```




    0




```python
# —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤:
costs.columns = costs.columns.str.lower()
```


```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
costs.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1800 entries, 0 to 1799
    Data columns (total 3 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   dt       1800 non-null   object 
     1   channel  1800 non-null   object 
     2   costs    1800 non-null   float64
    dtypes: float64(1), object(2)
    memory usage: 42.3+ KB



```python
# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏:
costs['dt'] = pd.to_datetime(costs['dt']).dt.date
```


```python
#–ø—Ä–æ–≤–µ—Ä–∏–º –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
print(pd.DataFrame(round((visits.isna().mean()*100),2)))
print(pd.DataFrame(round((orders.isna().mean()*100),2)))
print(pd.DataFrame(round((costs.isna().mean()*100),2)))
```

                     0
    user_id        0.0
    region         0.0
    device         0.0
    channel        0.0
    session_start  0.0
    session_end    0.0
                0
    user_id   0.0
    event_dt  0.0
    revenue   0.0
               0
    dt       0.0
    channel  0.0
    costs    0.0


–ú—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –∏—Ö –∫ –∞–Ω–∞–ª–∏–∑—É (—É–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –ø–æ–º–µ–Ω—è–ª–∏ —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏–π).

<div class="alert alert-warning">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∫ –∞–Ω–∞–ª–∏–∑—É, –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –æ—à–∏–±–∫–∏! –õ—É—á—à–µ, —Ç–∞–∫-–∂–µ –æ—Ç–¥–µ–ª—å–Ω–æ, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –º–µ—Ç–æ–¥–æ–º isna() –∏–ª–∏ isnull(). –°–º–æ—Ç—Ä—è —á–µ—Ä–µ–∑ info(), –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º–Ω–æ–≥–æ –∫–æ–ª–æ–Ω–æ–∫, –º–æ–∂–Ω–æ –∏—Ö –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.
–ù–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫, —Ç—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º:
```python
round((df.isna().mean()*100),2)
```  
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚úîÔ∏è –•–æ—Ä–æ—à–æ, —Ç–∞–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–∞, —Å—Ä–∞–∑—É –≤–∏–¥–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ —è—Å–Ω–æ, –≥–¥–µ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –∞ –≥–¥–µ –ø—Ä–∏–¥–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω—è—Ç—å. üôÇ
</div>

### –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ LTV, ROI, —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π

def get_profiles(sessions, orders, events, ad_costs, event_names=[]):

    # –Ω–∞—Ö–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–≤—ã—Ö –ø–æ—Å–µ—â–µ–Ω–∏–π
    profiles = (
        sessions.sort_values(by=['user_id', 'session_start'])
        .groupby('user_id')
        .agg(
            {
                'session_start': 'first',
                'channel': 'first',
                'device': 'first',
                'region': 'first',
            }
        )
        .rename(columns={'session_start': 'first_ts'})
        .reset_index()
    )

    # –¥–ª—è –∫–æ–≥–æ—Ä—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞—Ç—É –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è
    # –∏ –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ø–æ—Å–µ—â–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ
    profiles['dt'] = profiles['first_ts'].dt.date
    profiles['month'] = profiles['first_ts'].astype('datetime64[M]')

    # –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    profiles['payer'] = profiles['user_id'].isin(orders['user_id'].unique())

    # –¥–æ–±–∞–≤–ª—è–µ–º —Ñ–ª–∞–≥–∏ –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ event_names
    for event in event_names:
        if event in events['event_name'].unique():
            profiles[event] = profiles['user_id'].isin(
                events.query('event_name == @event')['user_id'].unique()
            )

    # —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏ –¥–∞—Ç–æ–π –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è
    new_users = (
        profiles.groupby(['dt', 'channel'])
        .agg({'user_id': 'nunique'})
        .rename(columns={'user_id': 'unique_users'})
        .reset_index()
    )

    # –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–µ–∫–ª–∞–º—É –∏ —á–∏—Å–ª–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ad_costs = ad_costs.merge(new_users, on=['dt', 'channel'], how='left')

    # –¥–µ–ª–∏–º —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —á–∏—Å–ª–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ad_costs['acquisition_cost'] = ad_costs['costs'] / ad_costs['unique_users']

    # –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    profiles = profiles.merge(
        ad_costs[['dt', 'channel', 'acquisition_cost']],
        on=['dt', 'channel'],
        how='left',
    )

    # —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞–≤–Ω–∞ –Ω—É–ª—é
    profiles['acquisition_cost'] = profiles['acquisition_cost'].fillna(0)

    return profiles
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è

def get_retention(
    profiles,
    sessions,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü payer –≤ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π dimensions —Å–ø–∏—Å–æ–∫
    dimensions = ['payer'] + dimensions

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')

    # —Å–æ–±–∏—Ä–∞–µ–º ¬´—Å—ã—Ä—ã–µ¬ª –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_raw = result_raw.merge(
        sessions[['user_id', 'session_start']], on='user_id', how='left'
    )
    result_raw['lifetime'] = (
        result_raw['session_start'] - result_raw['first_ts']
    ).dt.days

    # —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        result = df.pivot_table(
            index=dims, columns='lifetime', values='user_id', aggfunc='nunique'
        )
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        result = result.div(result['cohort_size'], axis=0)
        result = result[['cohort_size'] + list(range(horizon_days))]
        result['cohort_size'] = cohort_sizes
        return result

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_grouped = group_by_dimensions(result_raw, dimensions, horizon_days)

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∏–Ω–∞–º–∏–∫–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
    result_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
    return result_raw, result_grouped, result_in_time
```


```python

# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

def get_conversion(
    profiles,
    purchases,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')

    # –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    first_purchases = (
        purchases.sort_values(by=['user_id', 'event_dt'])
        .groupby('user_id')
        .agg({'event_dt': 'first'})
        .reset_index()
    )

    # –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    result_raw = result_raw.merge(
        first_purchases[['user_id', 'event_dt']], on='user_id', how='left'
    )

    # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π—Ñ—Ç–∞–π–º –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏
    result_raw['lifetime'] = (
        result_raw['event_dt'] - result_raw['first_ts']
    ).dt.days

    # –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ cohort, –µ—Å–ª–∏ –≤ dimensions –Ω–∏—á–µ–≥–æ –Ω–µ—Ç
    if len(dimensions) == 0:
        result_raw['cohort'] = 'All users' 
        dimensions = dimensions + ['cohort']

    # —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        result = df.pivot_table(
            index=dims, columns='lifetime', values='user_id', aggfunc='nunique'
        )
        result = result.fillna(0).cumsum(axis = 1)
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        # –¥–µ–ª–∏–º –∫–∞–∂–¥—É—é ¬´—è—á–µ–π–∫—É¬ª –≤ —Å—Ç—Ä–æ–∫–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–æ–≥–æ—Ä—Ç—ã
        # –∏ –ø–æ–ª—É—á–∞–µ–º conversion rate
        result = result.div(result['cohort_size'], axis=0)
        result = result[['cohort_size'] + list(range(horizon_days))]
        result['cohort_size'] = cohort_sizes
        return result

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    result_grouped = group_by_dimensions(result_raw, dimensions, horizon_days)

    # –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –¥–∏–Ω–∞–º–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —É–±–∏—Ä–∞–µ–º 'cohort' –∏–∑ dimensions
    if 'cohort' in dimensions: 
        dimensions = []

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∏–Ω–∞–º–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    result_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
    return result_raw, result_grouped, result_in_time
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ LTV –∏ ROI

def get_ltv(
    profiles,
    purchases,
    observation_date,
    horizon_days,
    dimensions=[],
    ignore_horizon=False,
):

    # –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ ¬´–¥–æ–∂–∏–≤—à–∏—Ö¬ª –¥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞
    last_suitable_acquisition_date = observation_date
    if not ignore_horizon:
        last_suitable_acquisition_date = observation_date - timedelta(
            days=horizon_days - 1
        )
    result_raw = profiles.query('dt <= @last_suitable_acquisition_date')
    # –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–∏
    result_raw = result_raw.merge(
        purchases[['user_id', 'event_dt', 'revenue']], on='user_id', how='left'
    )
    # —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∞–π—Ñ—Ç–∞–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏
    result_raw['lifetime'] = (
        result_raw['event_dt'] - result_raw['first_ts']
    ).dt.days
    # –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ cohort, –µ—Å–ª–∏ –≤ dimensions –Ω–∏—á–µ–≥–æ –Ω–µ—Ç
    if len(dimensions) == 0:
        result_raw['cohort'] = 'All users'
        dimensions = dimensions + ['cohort']

    # —Ñ—É–Ω–∫—Ü–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –∂–µ–ª–∞–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
    def group_by_dimensions(df, dims, horizon_days):
        # —Å—Ç—Ä–æ–∏–º ¬´—Ç—Ä–µ—É–≥–æ–ª—å–Ω—É—é¬ª —Ç–∞–±–ª–∏—Ü—É –≤—ã—Ä—É—á–∫–∏
        result = df.pivot_table(
            index=dims, columns='lifetime', values='revenue', aggfunc='sum'
        )
        # –Ω–∞—Ö–æ–¥–∏–º —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏ —Å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ–º
        result = result.fillna(0).cumsum(axis=1)
        # –≤—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
        cohort_sizes = (
            df.groupby(dims)
            .agg({'user_id': 'nunique'})
            .rename(columns={'user_id': 'cohort_size'})
        )
        # –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ —Ç–∞–±–ª–∏—Ü—É –≤—ã—Ä—É—á–∫–∏
        result = cohort_sizes.merge(result, on=dims, how='left').fillna(0)
        # —Å—á–∏—Ç–∞–µ–º LTV: –¥–µ–ª–∏–º –∫–∞–∂–¥—É—é ¬´—è—á–µ–π–∫—É¬ª –≤ —Å—Ç—Ä–æ–∫–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–æ–≥–æ—Ä—Ç—ã
        result = result.div(result['cohort_size'], axis=0)
        # –∏—Å–∫–ª—é—á–∞–µ–º –≤—Å–µ –ª–∞–π—Ñ—Ç–∞–π–º—ã, –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
        result = result[['cohort_size'] + list(range(horizon_days))]
        # –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
        result['cohort_size'] = cohort_sizes

        # —Å–æ–±–∏—Ä–∞–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ CAC, 
        # –¥–æ–±–∞–≤–ª—è—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ dimensions
        cac = df[['user_id', 'acquisition_cost'] + dims].drop_duplicates()

        # —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π CAC –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏–∑ dimensions
        cac = (
            cac.groupby(dims)
            .agg({'acquisition_cost': 'mean'})
            .rename(columns={'acquisition_cost': 'cac'})
        )

        # —Å—á–∏—Ç–∞–µ–º ROI: –¥–µ–ª–∏–º LTV –Ω–∞ CAC
        roi = result.div(cac['cac'], axis=0)

        # —É–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º ROI
        roi = roi[~roi['cohort_size'].isin([np.inf])]

        # –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ ROI
        roi['cohort_size'] = cohort_sizes

        # –¥–æ–±–∞–≤–ª—è–µ–º CAC –≤ —Ç–∞–±–ª–∏—Ü—É ROI
        roi['cac'] = cac['cac']

        # –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç, CAC
        # –∏ ROI –≤ –ª–∞–π—Ñ—Ç–∞–π–º—ã, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞
        roi = roi[['cohort_size', 'cac'] + list(range(horizon_days))]

        # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã LTV –∏ ROI
        return result, roi

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã LTV –∏ ROI
    result_grouped, roi_grouped = group_by_dimensions(
        result_raw, dimensions, horizon_days
    )

    # –¥–ª—è —Ç–∞–±–ª–∏—Ü –¥–∏–Ω–∞–º–∏–∫–∏ —É–±–∏—Ä–∞–µ–º 'cohort' –∏–∑ dimensions
    if 'cohort' in dimensions:
        dimensions = []

    # –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –¥–∏–Ω–∞–º–∏–∫–∏ LTV –∏ ROI
    result_in_time, roi_in_time = group_by_dimensions(
        result_raw, dimensions + ['dt'], horizon_days
    )

    return (
        result_raw,  # —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
        result_grouped,  # —Ç–∞–±–ª–∏—Ü–∞ LTV
        result_in_time,  # —Ç–∞–±–ª–∏—Ü–∞ –¥–∏–Ω–∞–º–∏–∫–∏ LTV
        roi_grouped,  # —Ç–∞–±–ª–∏—Ü–∞ ROI
        roi_in_time,  # —Ç–∞–±–ª–∏—Ü–∞ –¥–∏–Ω–∞–º–∏–∫–∏ ROI
    )
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

def plot_retention(retention, retention_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 10))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
    retention = retention.drop(columns=['cohort_size', 0])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    retention_history = retention_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –µ—Å–ª–∏ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö —Ç–∞–±–ª–∏—Ü—ã —É–¥–µ—Ä–∂–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ payer,
    # –¥–æ–±–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–∑–Ω–∞–∫ ‚Äî cohort
    if retention.index.nlevels == 1:
        retention['cohort'] = 'All users'
        retention = retention.reset_index().set_index(['cohort', 'payer'])

    # –≤ —Ç–∞–±–ª–∏—Ü–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ ‚Äî –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –∏ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏
    # –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ax1 = plt.subplot(2, 2, 1)
    retention.query('payer == True').droplevel('payer').T.plot(
        grid=True, ax=ax1
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤–æ –≤—Ç–æ—Ä–æ–π —è—á–µ–π–∫–µ —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    # –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –æ—Å—å ‚Äî –æ—Ç –≥—Ä–∞—Ñ–∏–∫–∞ –∏–∑ –ø–µ—Ä–≤–æ–π —è—á–µ–π–∫–∏
    ax2 = plt.subplot(2, 2, 2, sharey=ax1)
    retention.query('payer == False').droplevel('payer').T.plot(
        grid=True, ax=ax2
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤ —Ç—Ä–µ—Ç—å–µ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö
    ax3 = plt.subplot(2, 2, 3)
    # –ø–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    columns = [
        name
        for name in retention_history.index.names
        if name not in ['dt', 'payer']
    ]
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == True').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )

    # –≤ —á—ë—Ç–≤–µ—Ä—Ç–æ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    ax4 = plt.subplot(2, 2, 4, sharey=ax3)
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == False').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax4)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )
    
    plt.tight_layout()
    plt.show()
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

def plot_conversion(conversion, conversion_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 5))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    conversion = conversion.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    conversion_history = conversion_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax1 = plt.subplot(1, 2, 1)
    conversion.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax2 = plt.subplot(1, 2, 2, sharey=ax1)
    columns = [
        # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
        name for name in conversion_history.index.names if name not in ['dt']
    ]
    filtered_data = conversion_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show()
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ LTV –∏ ROI

def plot_ltv_roi(ltv, ltv_history, roi, roi_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Å–µ—Ç–∫—É –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(20, 10))

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ltv –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    ltv = ltv.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ ltv –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    ltv_history = ltv_history.drop(columns=['cohort_size'])[[horizon - 1]]

    # —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∑–∞–ø–∏—à–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º
    cac_history = roi_history[['cac']]

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã roi –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ cac
    roi = roi.drop(columns=['cohort_size', 'cac'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ roi –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    roi_history = roi_history.drop(columns=['cohort_size', 'cac'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ ltv
    ax1 = plt.subplot(2, 3, 1)
    ltv.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('LTV')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ ltv
    ax2 = plt.subplot(2, 3, 2, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in ltv_history.index.names if name not in ['dt']]
    filtered_data = ltv_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ LTV –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    # —Ç—Ä–µ—Ç–∏–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ cac
    ax3 = plt.subplot(2, 3, 3, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in cac_history.index.names if name not in ['dt']]
    filtered_data = cac_history.pivot_table(
        index='dt', columns=columns, values='cac', aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ roi
    ax4 = plt.subplot(2, 3, 4)
    roi.T.plot(grid=True, ax=ax4)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('ROI')

    # –ø—è—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ roi
    ax5 = plt.subplot(2, 3, 5, sharey=ax4)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in roi_history.index.names if name not in ['dt']]
    filtered_data = roi_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax5)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show()
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è —Ñ—Ä–µ–π–º–∞

def filter_data(df, window):
    # –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
    for column in df.columns.values:
        df[column] = df[column].rolling(window).mean() 
    return df
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

def plot_retention(retention, retention_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 10))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
    retention = retention.drop(columns=['cohort_size', 0])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    retention_history = retention_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –µ—Å–ª–∏ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö —Ç–∞–±–ª–∏—Ü—ã —É–¥–µ—Ä–∂–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ payer,
    # –¥–æ–±–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–∑–Ω–∞–∫ ‚Äî cohort
    if retention.index.nlevels == 1:
        retention['cohort'] = 'All users'
        retention = retention.reset_index().set_index(['cohort', 'payer'])

    # –≤ —Ç–∞–±–ª–∏—Ü–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ ‚Äî –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –∏ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏
    # –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ax1 = plt.subplot(2, 2, 1)
    retention.query('payer == True').droplevel('payer').T.plot(
        grid=True, ax=ax1
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤–æ –≤—Ç–æ—Ä–æ–π —è—á–µ–π–∫–µ —Å—Ç—Ä–æ–∏–º –∫—Ä–∏–≤—ã–µ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    # –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –æ—Å—å ‚Äî –æ—Ç –≥—Ä–∞—Ñ–∏–∫–∞ –∏–∑ –ø–µ—Ä–≤–æ–π —è—á–µ–π–∫–∏
    ax2 = plt.subplot(2, 2, 2, sharey=ax1)
    retention.query('payer == False').droplevel('payer').T.plot(
        grid=True, ax=ax2
    )
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–£–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤ —Ç—Ä–µ—Ç—å–µ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö
    ax3 = plt.subplot(2, 2, 3)
    # –ø–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    columns = [
        name
        for name in retention_history.index.names
        if name not in ['dt', 'payer']
    ]
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == True').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )

    # –≤ —á—ë—Ç–≤–µ—Ä—Ç–æ–π —è—á–µ–π–∫–µ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö
    ax4 = plt.subplot(2, 2, 4, sharey=ax3)
    # —Ñ–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
    filtered_data = retention_history.query('payer == False').pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax4)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title(
        '–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(
            horizon
        )
    )
    
    plt.tight_layout()
    plt.show()
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

def plot_conversion(conversion, conversion_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(15, 5))

    # –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    conversion = conversion.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    conversion_history = conversion_history.drop(columns=['cohort_size'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax1 = plt.subplot(1, 2, 1)
    conversion.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('–ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
    ax2 = plt.subplot(1, 2, 2, sharey=ax1)
    columns = [
        # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
        name for name in conversion_history.index.names if name not in ['dt']
    ]
    filtered_data = conversion_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show()
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ LTV –∏ ROI

def plot_ltv_roi(ltv, ltv_history, roi, roi_history, horizon, window=7):

    # –∑–∞–¥–∞—ë–º —Å–µ—Ç–∫—É –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    plt.figure(figsize=(20, 10))

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ltv –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç
    ltv = ltv.drop(columns=['cohort_size'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ ltv –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    ltv_history = ltv_history.drop(columns=['cohort_size'])[[horizon - 1]]

    # —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∑–∞–ø–∏—à–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ—Ä–µ–π–º
    cac_history = roi_history[['cac']]

    # –∏–∑ —Ç–∞–±–ª–∏—Ü—ã roi –∏—Å–∫–ª—é—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–≥–æ—Ä—Ç –∏ cac
    roi = roi.drop(columns=['cohort_size', 'cac'])
    # –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–∏–Ω–∞–º–∏–∫–∏ roi –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –ª–∞–π—Ñ—Ç–∞–π–º
    roi_history = roi_history.drop(columns=['cohort_size', 'cac'])[
        [horizon - 1]
    ]

    # –ø–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ ltv
    ax1 = plt.subplot(2, 3, 1)
    ltv.T.plot(grid=True, ax=ax1)
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('LTV')

    # –≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ ltv
    ax2 = plt.subplot(2, 3, 2, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in ltv_history.index.names if name not in ['dt']]
    filtered_data = ltv_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax2)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ LTV –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    # —Ç—Ä–µ—Ç–∏–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ cac
    ax3 = plt.subplot(2, 3, 3, sharey=ax1)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in cac_history.index.names if name not in ['dt']]
    filtered_data = cac_history.pivot_table(
        index='dt', columns=columns, values='cac', aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax3)
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')

    # —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –∫—Ä–∏–≤—ã–µ roi
    ax4 = plt.subplot(2, 3, 4)
    roi.T.plot(grid=True, ax=ax4)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.legend()
    plt.xlabel('–õ–∞–π—Ñ—Ç–∞–π–º')
    plt.title('ROI')

    # –ø—è—Ç—ã–π –≥—Ä–∞—Ñ–∏–∫ ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ roi
    ax5 = plt.subplot(2, 3, 5, sharey=ax4)
    # —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω—É—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–Ω–¥–µ–∫—Å–∞, –∫—Ä–æ–º–µ –¥–∞—Ç—ã
    columns = [name for name in roi_history.index.names if name not in ['dt']]
    filtered_data = roi_history.pivot_table(
        index='dt', columns=columns, values=horizon - 1, aggfunc='mean'
    )
    filter_data(filtered_data, window).plot(grid=True, ax=ax5)
    plt.axhline(y=1, color='red', linestyle='--', label='–£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏')
    plt.xlabel('–î–∞—Ç–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è')
    plt.title('–î–∏–Ω–∞–º–∏–∫–∞ ROI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ {}-–π –¥–µ–Ω—å'.format(horizon))

    plt.tight_layout()
    plt.show()
```

–ú—ã –∑–∞–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ LTV, ROI, —É–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.

<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –û—Ç–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏! üëç
</div>

### –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.


```python
# –ø–æ–ª—É—á–∏–º –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
profiles = get_profiles(visits, orders, events, costs)
profiles.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>first_ts</th>
      <th>channel</th>
      <th>device</th>
      <th>region</th>
      <th>dt</th>
      <th>month</th>
      <th>payer</th>
      <th>acquisition_cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>599326</td>
      <td>2019-05-07 20:58:57</td>
      <td>FaceBoom</td>
      <td>Mac</td>
      <td>United States</td>
      <td>2019-05-07</td>
      <td>2019-05-01</td>
      <td>True</td>
      <td>1.088172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4919697</td>
      <td>2019-07-09 12:46:07</td>
      <td>FaceBoom</td>
      <td>iPhone</td>
      <td>United States</td>
      <td>2019-07-09</td>
      <td>2019-07-01</td>
      <td>False</td>
      <td>1.107237</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6085896</td>
      <td>2019-10-01 09:58:33</td>
      <td>organic</td>
      <td>iPhone</td>
      <td>France</td>
      <td>2019-10-01</td>
      <td>2019-10-01</td>
      <td>False</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22593348</td>
      <td>2019-08-22 21:35:48</td>
      <td>AdNonSense</td>
      <td>PC</td>
      <td>Germany</td>
      <td>2019-08-22</td>
      <td>2019-08-01</td>
      <td>False</td>
      <td>0.988235</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31989216</td>
      <td>2019-10-02 00:07:44</td>
      <td>YRabbit</td>
      <td>iPhone</td>
      <td>United States</td>
      <td>2019-10-02</td>
      <td>2019-10-01</td>
      <td>False</td>
      <td>0.230769</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –æ–ø—Ä–µ–¥–µ–ª–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—ã –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
print('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞', profiles['first_ts'].min())
print('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞',profiles['first_ts'].max())
```

    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ 2019-05-01 00:00:41
    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ 2019-10-27 23:59:04


<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ, —É –Ω–∞—Å –µ—Å—Ç—å –¥–∞—Ç—ã –∏ –æ–Ω–∏ –¥–∞–∂–µ –≤ —Ä–∞–º–∫–∞—Ö 1 –≥–æ–¥–∞!
</div>

#### –ò–∑ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞ –∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π? –¢–∞–±–ª–∏—Ü–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã:
region = pd.pivot_table(profiles, columns='region', values = 'user_id', aggfunc=(lambda x: x.count()))
region = region.max().sort_values(ascending=False).reset_index()
region
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>100002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>UK</td>
      <td>17575</td>
    </tr>
    <tr>
      <th>2</th>
      <td>France</td>
      <td>17450</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Germany</td>
      <td>14981</td>
    </tr>
  </tbody>
</table>
</div>



–í–∏–¥–∏–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω:
- –°–®–ê;
- –í–µ–ª–∏–∫–æ–±—Ä–µ—Ç–∞–Ω–∏—è;
- –§—Ä–∞–Ω—Ü–∏—è;
- –ì–µ—Ä–º–∞–Ω–∏—è.


```python
# –í—ã—á–∏—Å–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º:
region_payers = pd.pivot_table(profiles.query('payer == True'), columns='region', values = 'user_id', aggfunc=(lambda x: x.count()))
region_payers=region_payers.max().sort_values(ascending=False).reset_index()
region_payers
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>6902</td>
    </tr>
    <tr>
      <th>1</th>
      <td>UK</td>
      <td>700</td>
    </tr>
    <tr>
      <th>2</th>
      <td>France</td>
      <td>663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Germany</td>
      <td>616</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã:
region_payers=region_payers.merge(region, on = 'region')
region_payers.rename(columns={'0_x': 'Payers'}, inplace=True)
region_payers.rename(columns={'0_y': 'Clients'}, inplace=True)
region_payers['%_payers'] =region_payers['Payers'] / region_payers['Clients'] * 100
region_payers
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>Payers</th>
      <th>Clients</th>
      <th>%_payers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>6902</td>
      <td>100002</td>
      <td>6.901862</td>
    </tr>
    <tr>
      <th>1</th>
      <td>UK</td>
      <td>700</td>
      <td>17575</td>
      <td>3.982930</td>
    </tr>
    <tr>
      <th>2</th>
      <td>France</td>
      <td>663</td>
      <td>17450</td>
      <td>3.799427</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Germany</td>
      <td>616</td>
      <td>14981</td>
      <td>4.111875</td>
    </tr>
  </tbody>
</table>
</div>



–ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –°–®–ê (6,9% –æ—Ç –≤—Å–µ—Ö –æ–ø–ª–∞—Ç).

<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –ù–∞—Å –ø—Ä–æ—Å—è—Ç —Ä–∞—Å—á–∏—Å—Ç–∏—Ç—å –Ω–µ –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–ª–∞—Ç—è—â–∏—Ö, –∞ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –°–®–ê: –¥–µ–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 6902 / 100002 = 0,069 —Ç.–µ. 6,9%. 
    
–ü–µ—Ä–µ—Å—á–∏—Ç–∞–π —Ç—É—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å –ø–æ –¥–µ–≤–∞–π—Å–∞–º —Å —Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏.
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚úîÔ∏è –° –ø–ª–∞—Ç—è—â–∏–º–∏ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å! üëç
    
</div>

#### –ö–∞–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—ã –∏ –∫–∞–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏? –¢–∞–±–ª–∏—Ü–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
device = pd.pivot_table(profiles, columns='device', values = 'user_id', aggfunc=(lambda x: x.count()))
device = device.max().sort_values(ascending=False).reset_index()
device
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iPhone</td>
      <td>54479</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Android</td>
      <td>35032</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PC</td>
      <td>30455</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mac</td>
      <td>30042</td>
    </tr>
  </tbody>
</table>
</div>



–í–∏–¥–∏–º, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏:
- iPhone;
- Android;
- PC;
- Mac.


```python
# –í—ã—á–∏—Å–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º:
device_payers = pd.pivot_table(profiles.query('payer == True'), columns='device', values = 'user_id', aggfunc=(lambda x: x.count()))
device_payers=device_payers.max().sort_values(ascending=False).reset_index()
device_payers
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>iPhone</td>
      <td>3382</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Android</td>
      <td>2050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mac</td>
      <td>1912</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC</td>
      <td>1537</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
device_payers=device_payers.merge(device, on = 'device')
device_payers.rename(columns={'0_x': 'Payers'}, inplace=True)
device_payers.rename(columns={'0_y': 'Clients'}, inplace=True)
device_payers['%_payers'] =device_payers['Payers'] / device_payers['Clients'] * 100
device_payers.sort_values(by = '%_payers', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>device</th>
      <th>Payers</th>
      <th>Clients</th>
      <th>%_payers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Mac</td>
      <td>1912</td>
      <td>30042</td>
      <td>6.364423</td>
    </tr>
    <tr>
      <th>0</th>
      <td>iPhone</td>
      <td>3382</td>
      <td>54479</td>
      <td>6.207897</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Android</td>
      <td>2050</td>
      <td>35032</td>
      <td>5.851793</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PC</td>
      <td>1537</td>
      <td>30455</td>
      <td>5.046790</td>
    </tr>
  </tbody>
</table>
</div>



–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —É iPhone (6,4% –æ—Ç –≤—Å–µ—Ö –æ–ø–ª–∞—Ç).

#### –†–µ–∫–ª–∞–º–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∏ –∫–∞–Ω–∞–ª—ã, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—à–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –¢–∞–±–ª–∏—Ü–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è.


```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è:
channel = pd.pivot_table(profiles, columns='channel', values = 'user_id', aggfunc=(lambda x: x.count()))
channel = channel.max().sort_values(ascending=False).reset_index()
channel
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>channel</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>organic</td>
      <td>56439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FaceBoom</td>
      <td>29144</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TipTop</td>
      <td>19561</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OppleCreativeMedia</td>
      <td>8605</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LeapBob</td>
      <td>8553</td>
    </tr>
    <tr>
      <th>5</th>
      <td>WahooNetBanner</td>
      <td>8553</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RocketSuperAds</td>
      <td>4448</td>
    </tr>
    <tr>
      <th>7</th>
      <td>MediaTornado</td>
      <td>4364</td>
    </tr>
    <tr>
      <th>8</th>
      <td>YRabbit</td>
      <td>4312</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AdNonSense</td>
      <td>3880</td>
    </tr>
    <tr>
      <th>10</th>
      <td>lambdaMediaAds</td>
      <td>2149</td>
    </tr>
  </tbody>
</table>
</div>



–í–∏–¥–∏–º, —á—Ç–æ –æ–∫–æ–ª–æ 1/3 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—à–ª–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ "–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–≥–æ‚Äù –ø–æ–∏—Å–∫–∞, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã–ª–∏ –ø—Ä–∏—Å–ª–µ—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ä–µ–∫–ª–∞–º–Ω–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏:
- FaceBoom;
- TipTop;
- OppleCreativeMedia;
- LeapBob;
- WahooNetBanner;
- RocketSuperAds;
- MediaTornado;
- YRabbit;
- AdNonSense;
- lambdaMediaAds.      


```python
# –í—ã—á–∏—Å–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∫–∞–Ω–∞–ª–∞–º:
channel_payers = pd.pivot_table(profiles.query('payer == True'), columns='channel', values = 'user_id', aggfunc=(lambda x: x.count()))
channel_payers=channel_payers.max().sort_values(ascending=False).reset_index()
channel_payers
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>channel</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FaceBoom</td>
      <td>3557</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TipTop</td>
      <td>1878</td>
    </tr>
    <tr>
      <th>2</th>
      <td>organic</td>
      <td>1160</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WahooNetBanner</td>
      <td>453</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AdNonSense</td>
      <td>440</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RocketSuperAds</td>
      <td>352</td>
    </tr>
    <tr>
      <th>6</th>
      <td>LeapBob</td>
      <td>262</td>
    </tr>
    <tr>
      <th>7</th>
      <td>OppleCreativeMedia</td>
      <td>233</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lambdaMediaAds</td>
      <td>225</td>
    </tr>
    <tr>
      <th>9</th>
      <td>YRabbit</td>
      <td>165</td>
    </tr>
    <tr>
      <th>10</th>
      <td>MediaTornado</td>
      <td>156</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è:
channel_payers=channel_payers.merge(channel, on = 'channel')
channel_payers.rename(columns={'0_x': 'Payers'}, inplace=True)
channel_payers.rename(columns={'0_y': 'Clients'}, inplace=True)
channel_payers['%_payers'] =channel_payers['Payers'] / channel_payers['Clients'] * 100
channel_payers.sort_values(by = '%_payers', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>channel</th>
      <th>Payers</th>
      <th>Clients</th>
      <th>%_payers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FaceBoom</td>
      <td>3557</td>
      <td>29144</td>
      <td>12.204914</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AdNonSense</td>
      <td>440</td>
      <td>3880</td>
      <td>11.340206</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lambdaMediaAds</td>
      <td>225</td>
      <td>2149</td>
      <td>10.469986</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TipTop</td>
      <td>1878</td>
      <td>19561</td>
      <td>9.600736</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RocketSuperAds</td>
      <td>352</td>
      <td>4448</td>
      <td>7.913669</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WahooNetBanner</td>
      <td>453</td>
      <td>8553</td>
      <td>5.296387</td>
    </tr>
    <tr>
      <th>9</th>
      <td>YRabbit</td>
      <td>165</td>
      <td>4312</td>
      <td>3.826531</td>
    </tr>
    <tr>
      <th>10</th>
      <td>MediaTornado</td>
      <td>156</td>
      <td>4364</td>
      <td>3.574702</td>
    </tr>
    <tr>
      <th>6</th>
      <td>LeapBob</td>
      <td>262</td>
      <td>8553</td>
      <td>3.063253</td>
    </tr>
    <tr>
      <th>7</th>
      <td>OppleCreativeMedia</td>
      <td>233</td>
      <td>8605</td>
      <td>2.707728</td>
    </tr>
    <tr>
      <th>2</th>
      <td>organic</td>
      <td>1160</td>
      <td>56439</td>
      <td>2.055316</td>
    </tr>
  </tbody>
</table>
</div>



–í–∏–¥–∏–º, —á—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä–µ–∫–ª–∞–º–Ω–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É FaceBoom (12,2% –æ—Ç –≤—Å–µ—Ö –æ–ø–ª–∞—Ç).

### –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥

#### –û–±—â–∞—è —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.


```python
# –æ–ø—Ä–µ–¥–µ–ª–∏–º –æ–±—â—É—é —Å—É–º–º—É —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥:
costs['costs'].sum()
```




    105497.30000000002



–û–±—â–∞—è —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç $105 497.


```python
# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–∏—Ö –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º:
costs_by_channel = pd.pivot_table(costs, index = 'channel', values = 'costs', aggfunc=sum).sort_values(by = 'costs', ascending=False)
costs_by_channel
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>costs</th>
    </tr>
    <tr>
      <th>channel</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TipTop</th>
      <td>54751.30</td>
    </tr>
    <tr>
      <th>FaceBoom</th>
      <td>32445.60</td>
    </tr>
    <tr>
      <th>WahooNetBanner</th>
      <td>5151.00</td>
    </tr>
    <tr>
      <th>AdNonSense</th>
      <td>3911.25</td>
    </tr>
    <tr>
      <th>OppleCreativeMedia</th>
      <td>2151.25</td>
    </tr>
    <tr>
      <th>RocketSuperAds</th>
      <td>1833.00</td>
    </tr>
    <tr>
      <th>LeapBob</th>
      <td>1797.60</td>
    </tr>
    <tr>
      <th>lambdaMediaAds</th>
      <td>1557.60</td>
    </tr>
    <tr>
      <th>MediaTornado</th>
      <td>954.48</td>
    </tr>
    <tr>
      <th>YRabbit</th>
      <td>944.22</td>
    </tr>
  </tbody>
</table>
</div>




```python
costs_pivot = pd.pivot_table(costs, index = 'dt', columns='channel', values = 'costs', aggfunc=sum)
costs_pivot.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>channel</th>
      <th>AdNonSense</th>
      <th>FaceBoom</th>
      <th>LeapBob</th>
      <th>MediaTornado</th>
      <th>OppleCreativeMedia</th>
      <th>RocketSuperAds</th>
      <th>TipTop</th>
      <th>WahooNetBanner</th>
      <th>YRabbit</th>
      <th>lambdaMediaAds</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-05-01</th>
      <td>40.95</td>
      <td>113.3</td>
      <td>2.52</td>
      <td>6.24</td>
      <td>4.25</td>
      <td>21.060</td>
      <td>80.0</td>
      <td>10.8</td>
      <td>8.1</td>
      <td>17.6</td>
    </tr>
    <tr>
      <th>2019-05-02</th>
      <td>34.65</td>
      <td>78.1</td>
      <td>2.94</td>
      <td>5.04</td>
      <td>4.25</td>
      <td>16.965</td>
      <td>55.0</td>
      <td>7.2</td>
      <td>9.9</td>
      <td>16.8</td>
    </tr>
    <tr>
      <th>2019-05-03</th>
      <td>47.25</td>
      <td>85.8</td>
      <td>2.73</td>
      <td>6.96</td>
      <td>5.75</td>
      <td>16.380</td>
      <td>64.0</td>
      <td>8.4</td>
      <td>9.0</td>
      <td>16.8</td>
    </tr>
    <tr>
      <th>2019-05-04</th>
      <td>51.45</td>
      <td>136.4</td>
      <td>3.99</td>
      <td>9.36</td>
      <td>4.25</td>
      <td>17.550</td>
      <td>70.0</td>
      <td>10.8</td>
      <td>15.6</td>
      <td>17.6</td>
    </tr>
    <tr>
      <th>2019-05-05</th>
      <td>36.75</td>
      <td>122.1</td>
      <td>4.62</td>
      <td>11.04</td>
      <td>5.50</td>
      <td>27.495</td>
      <td>78.0</td>
      <td>12.0</td>
      <td>9.6</td>
      <td>12.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
costs_pivot.plot(grid = True, figsize = (20,10))
plt.xlabel('–î–∞—Ç–∞')
plt.title('–†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ –∫–∞–Ω–∞–ª–∞–º')
plt.show()
```


    
![png](output_78_0.png)
    


<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è  –ù–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Ç—Ä–∞—Ç–∏—Ç—Å—è –±–æ–ª—å—à–µ.

</div> 

#### –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞. –°—Ä–µ–¥–Ω–∏–π CAC –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞.

<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚ùå –ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã—Å–∫–æ—á–∏–ª–∞ –æ—à–∏–±–∫–∞: `NameError`
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.3</b>
    
  ‚úîÔ∏è üëå
</div>


```python
# –æ–ø—Ä–µ–¥–µ–ª–∏–º —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:
df = costs_by_channel.merge(channel, on = 'channel')
df.rename(columns={0: 'Clients'}, inplace=True)
df['CAC'] = df['costs'] / df['Clients']
df.sort_values(by = 'CAC')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>channel</th>
      <th>costs</th>
      <th>Clients</th>
      <th>CAC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>LeapBob</td>
      <td>1797.60</td>
      <td>8553</td>
      <td>0.210172</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MediaTornado</td>
      <td>954.48</td>
      <td>4364</td>
      <td>0.218717</td>
    </tr>
    <tr>
      <th>9</th>
      <td>YRabbit</td>
      <td>944.22</td>
      <td>4312</td>
      <td>0.218975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>OppleCreativeMedia</td>
      <td>2151.25</td>
      <td>8605</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RocketSuperAds</td>
      <td>1833.00</td>
      <td>4448</td>
      <td>0.412095</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WahooNetBanner</td>
      <td>5151.00</td>
      <td>8553</td>
      <td>0.602245</td>
    </tr>
    <tr>
      <th>7</th>
      <td>lambdaMediaAds</td>
      <td>1557.60</td>
      <td>2149</td>
      <td>0.724802</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AdNonSense</td>
      <td>3911.25</td>
      <td>3880</td>
      <td>1.008054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FaceBoom</td>
      <td>32445.60</td>
      <td>29144</td>
      <td>1.113286</td>
    </tr>
    <tr>
      <th>0</th>
      <td>TipTop</td>
      <td>54751.30</td>
      <td>19561</td>
      <td>2.799003</td>
    </tr>
  </tbody>
</table>
</div>



–ú—ã —Ä–∞—Å—á–∏—Ç–∞–ª–∏ —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞. –°–∞–º—ã–º–∏ –Ω–µ–¥–æ—Ä–æ–≥–∏–º–∏ (—Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–∏–ª–∞ —á—É—Ç—å –±–æ–ª—å—à–µ $0,2) –æ–∫–∞–∑–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
- LeapBob;
- MediaTornado;
- YRabbit;
- OppleCreativeMedia. 

–°–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ (—Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–µ–≤—ã—Å–∏–ª–∞ $1) –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
- TipTop;
- FaceBoom;
- AdNonSense. 


```python
# –ø–æ—Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π CAC –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
df['costs'].sum() / df['Clients'].sum()
```




    1.1274813239427592



–°—Ä–µ–¥–Ω–∏–π CAC –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ü–µ–ª–æ–º —Å–æ—Å—Ç–∞–≤–∏–ª $1,13.

<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –ò –æ–±—Ö–æ–¥—è—Ç—Å—è –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –¥–æ—Ä–æ–∂–µ.

</div> 

### –ê–Ω–∞–ª–∏–∑ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã

#### –û–±—â–∞—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã. –ì—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.

–ß—Ç–æ–±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–Ω–∞–ª–∏–∑ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –ø—Ä–∏—à–µ–¥—à–∏–º —Ç–æ–ª—å–∫–æ —Å –ø–ª–∞—Ç–Ω—ãx —Ä–µ–∫–ª–∞–º–Ω—ãx –∫–∞–Ω–∞–ª–æ–≤. –ü–æ—ç—Ç–æ–º—É –∏–∑ —Ä–∞—Å—á–µ—Ç–æ–≤ –∏—Å–∫–ª—é—á–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–º —Ç—Ä–∞—Ñ–∏–∫–æ–º:


```python
profiles = profiles.query('channel != "organic"')
```


```python
# –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ 1 –Ω–æ—è–±—Ä—è 2019 –≥–æ–¥–∞ –∏ –∑–∞–¥–∞–¥–∏–º –º–æ–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞:
observation_date = datetime(2020, 11, 1).date()

# –∑–∞–¥–∞–¥–∏–º –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤ 2 –Ω–µ–¥–µ–ª–∏:
horizon_days = 14   

# —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º LTV –∏ ROI, –≤—ã–∑–≤–∞–≤ —Ñ—É–Ω–∫—Ü–∏–∏ get_ltv() –∏ plot_ltv_roi():
ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days
)

# —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏
plot_ltv_roi(ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days) 
```


    
![png](output_92_0.png)
    


–ü–æ –≥—Ä–∞—Ñ–∏–∫–∞–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã:
- –†–µ–∫–ª–∞–º–∞ –≤—Å–µ-—Ç–∞–∫–∏ –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è. ROI –¥–∞–∂–µ –≤ –∫–æ–Ω—Ü–µ –¥–≤—É—Ö –Ω–µ–¥–µ–ª—å –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 90%;
- CAC —É–≤–µ–ª–∏—á–∏–≤–∞–ª—Å—è ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –∏–∑-–∑–∞ —Ä–æ—Å—Ç–∞ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç–∞ —Å –∏—é–Ω—è, –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –º–µ—Å—è—Ü–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω;
- –ó–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –Ω–∞ LTV –Ω–µ–º–Ω–æ–≥–æ –≤–ª–∏—è–µ—Ç —Å–µ–∑–æ–Ω–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä, –Ω–æ —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —É—Ö—É–¥—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç;
- –¥–æ –∏—é–Ω—è-–∏—é–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ –æ–∫—É–ø–∞–ª–∏—Å—å, –Ω–æ –Ω–∞—á–∏–Ω–∞—è —Å –∞–≤–≥—É—Å—Ç–∞ ROI —É–∂–µ –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–ª 100%.    

–ß—Ç–æ–±—ã —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö, –ø—Ä–æ–π–¥—ë–º –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫—É, —Å—Ç—Ä–∞–Ω–µ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è.

<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –¢—É—Ç –µ—Å—Ç—å –æ–¥–∏–Ω –Ω–µ–¥–æ—á–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–∫–∞–∂–∞–µ—Ç –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ: –∏–∑ —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–∞–º —Å–ª–µ–¥—É–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–º —Ç—Ä–∞—Ñ–∏–∫–æ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –∑–∞ –Ω–∏—Ö –Ω–∏—á–µ–≥–æ –Ω–µ –ø–ª–∞—Ç–∏–º. –í—Å—é –æ—Ü–µ–Ω–∫—É –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –ø—Ä–∏—à–µ–¥—à–∏–º —Å –ø–ª–∞—Ç–Ω—ãx —Ä–µ–∫–ª–∞–º–Ω—ãx –∫–∞–Ω–∞–ª–æ–≤: 
```python
profiles = profiles.query('channel != "organic"')
```
–ü–µ—Ä–µ—Å—á–∏—Ç–∞–π –≤—Å–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞! –ü–æ—Å–º–æ—Ç—Ä–∏–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω—è—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫–∏. –ò –ø–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –≤—ã–≤–æ–¥—ã.
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚ùå –•–æ—Ä–æ—à–æ. –ù–æ —Ç–µ–ø–µ—Ä—å " ROI –¥–∞–∂–µ –≤ –∫–æ–Ω—Ü–µ –¥–≤—É—Ö –Ω–µ–¥–µ–ª—å ‚Äî –æ–∫–æ–ª–æ 95%" –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ç–µ–ø–µ—Ä—å –º–∞–∫—Å–∏–º—É–º –¥–æ 80% –¥–æ—Ö–æ–¥–∏—Ç. –ü–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –≤—ã–≤–æ–¥—ã.
</div>
<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.3</b>
    
  ‚úîÔ∏è –û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—ã–≤–æ–¥–∞–º.
</div>

#### –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º. –ì—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.

–ü—Ä–æ–≤–µ—Ä–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è. –í–æ–∑–º–æ–∂–Ω–æ, –Ω–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç –Ω–µ—É–¥–∞—á–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –≤ –∫–∞–∫–æ–º-–Ω–∏–±—É–¥—å –æ–¥–Ω–æ–º –∫–∞–Ω–∞–ª–µ.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è

dimensions = ['channel']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
)
```


    
![png](output_98_0.png)
    


–ü–æ —Ç–∞–∫–æ–º—É –Ω–∞–±–æ—Ä—É –≥—Ä–∞—Ñ–∏–∫–æ–≤ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–≤–æ–¥–æ–≤:
- –ª–∏–¥–µ—Ä—ã –ø–æ LTV ‚Äî —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Å–µ—Ç–∏ lambdaMediaAds –∏ TipTop. –í –∏—é–Ω–µ LTV 14-–≥–æ –¥–Ω—è —ç—Ç–æ–π —Å–µ—Ç–∏ —Ä–µ–∑–∫–æ –ø–æ–¥—Å–∫–æ—á–∏–ª, –æ–¥–Ω–∞–∫–æ –ø–æ–∑–¥–Ω–µ–µ —Å—Ç–∞–ª –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º;
- —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –æ–∫—É–ø–∞–µ—Ç—Å—è. –õ—É—á—à–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å ROI —É —Ç–∞–∫–∏—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –∫–∞–∫ YRabbit, MediaTornado, lambdaMediaAds, RocketSuperAds –∏ LeapBob. –°–µ—Ç—å YRabbit –æ—Å–æ–±–µ–Ω–Ω–æ –ª–∏–¥–∏—Ä—É–µ—Ç —Å –±–æ–ª—å—à–∏–º –æ—Ç—Ä—ã–≤–æ–º –¥–æ —Å–µ–Ω—Ç—è–±—Ä—è. –ê –≤–æ—Ç —Å–µ—Ç–∏ TipTop, FaceBoom –∏ AdNonSense —Å–æ–≤—Å–µ–º –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è;
- –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç CAC. –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –Ω–µ–º–Ω–æ–≥–æ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1 (—Å–∞–º–∞—è –Ω–∏–∑–∫–∞—è —É LeapBob, MediaTornado, YRabbit –∏ OppleCreativeMedia). CAC Faceboom —Å—Ç–∞–±–ª–∏–ª—å–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1,1. –ê –≤–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–µ—Ç–∏ TipTop ¬´—Å—Ç–æ—è—Ç¬ª –≤ —Ä–∞–∑—ã –¥–æ—Ä–æ–∂–µ –∏ CAC –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.

–í –±—É–¥—É—â–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –ø–æ—á–µ–º—É –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å TipTop —Ç–∞–∫–∞—è –Ω–∏–∑–∫–∞—è. 


```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –∫–∞–Ω–∞–ª–∞–º:

conversion_raw, conversion_grouped, conversion_history = get_conversion(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_conversion(conversion_grouped, conversion_history, horizon_days)
```


    
![png](output_100_0.png)
    


–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π FaceBoom, AdNonSense, lambdaMediaAds –∏ TipTop. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ –≤—Å–µ–º –∫–∞–Ω–∞–ª–∞–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∫—Ä–æ–º–µ "–≤—Å–ø–ª–µ—Å–∫–∞" –≤ –∏—é–Ω–µ –ø–æ lambdaMediaAds. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–µ:


```python
# —Å–º–æ—Ç—Ä–∏–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –∫–∞–Ω–∞–ª–∞–º:

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions=dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days)
```


    
![png](output_102_0.png)
    


–í–∏–¥–∏–º, —á—Ç–æ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ FaceBoom –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç –ø—Ä–æ—á–∏—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 15%.

<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –û–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–∞–Ω–∞–ª—ã!
</div>

#### –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º. –ì—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º

dimensions = ['region']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
)
```


    
![png](output_106_0.png)
    


–í–æ—Ç —á—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –≥—Ä–∞—Ñ–∏–∫–∏ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º:
- –†–µ–∫–ª–∞–º–∞ –æ–∫—É–ø–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ –∫—Ä–æ–º–µ –°–®–ê. –í –°–®–ê —Ä–µ–∫–ª–∞–º–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –æ–∫—É–ø–∞—Ç—å—Å—è —Å –∏—é–ª—è. –•–æ—Ç—è –∏–º–µ–Ω–Ω–æ –∫–ª–∏–µ–Ω—Ç—ã –∏–∑ –°–®–ê –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤—ã—Ä—É—á–∫–∏;
- –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω –∫—Ä–æ–º–µ –æ–ø—è—Ç—å –∂–µ –°–®–ê, –≥–¥–µ CAC –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª–∞ –≤—ã—à–µ –∏ —Å–∫–∞–∂–¥—ã–º –º–µ—Å—è—Ü–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞–ª–∞—Å—å;
- LTV –≤—Å—ë —Ç–∞–∫ –∂–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö;
- –õ—É—á—à–µ –≤—Å–µ–≥–æ –æ–∫—É–ø–∞–µ—Ç—Å—è –í–µ–ª–∏–∫–æ–±—Ä–µ—Ç–∞–Ω–∏—è.


```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º:

conversion_raw, conversion_grouped, conversion_history = get_conversion(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_conversion(conversion_grouped, conversion_history, horizon_days)
```


    
![png](output_108_0.png)
    


–°—É–¥—è –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –°–®–ê. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å—Ç–Ω–∞—è. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–µ:


```python
# —Å–º–æ—Ç—Ä–∏–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º:

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions=dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days)
```


    
![png](output_110_0.png)
    


–í–∏–¥–∏–º, —á—Ç–æ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –°–®–ê –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç –ø—Ä–æ—á–∏—Ö —Å—Ç—Ä–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 10%, –∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–∫—Ç—è–±—Ä—è –µ—â–µ –∏ —Å–Ω–∏–∂–∞–µ—Ç—Å—è.

<div class="alert alert-warning">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ö†Ô∏è –°–æ–≥–ª–∞—Å–µ–Ω, –º–æ–∂–Ω–æ –µ—â–µ –∏–∑—É—á–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –≤ –°–®–ê –æ—Ç–¥–µ–ª—å–Ω–æ.
</div>

#### –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º. –ì—Ä–∞—Ñ–∏–∫–∏ LTV –∏ ROI, –∞ —Ç–∞–∫–∂–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ LTV, CAC –∏ ROI.


```python
# —Å–º–æ—Ç—Ä–∏–º –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

dimensions = ['device']

ltv_raw, ltv_grouped, ltv_history, roi_grouped, roi_history = get_ltv(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_ltv_roi(
    ltv_grouped, ltv_history, roi_grouped, roi_history, horizon_days, window=14
)
```


    
![png](output_114_0.png)
    


–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ PC —Å—Ç–∞–±–∏–ª—å–Ω–æ –æ–∫—É–ø–∞—é—Ç—Å—è, –∞ –≤–æ—Ç –≤–ª–∞–¥–µ–ª—å—Ü—ã iPhone, Mac –∏ Android –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –æ–∫—É–ø–∞—Ç—å—Å—è –Ω–∞—á–∏–Ω–∞—è —Å –∏—é–ª—è.
–£–∑–Ω–∞–µ–º, –≤ —á—ë–º –ø—Ä–∏—á–∏–Ω–∞: –≤ –Ω–∏–∑–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏–ª–∏ –Ω–∏–∑–∫–æ–º —É–¥–µ—Ä–∂–∞–Ω–∏–∏.


```python
# —Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

conversion_raw, conversion_grouped, conversion_history = get_conversion(
    profiles, orders, observation_date, horizon_days, dimensions=dimensions
)

plot_conversion(conversion_grouped, conversion_history, horizon_days)
```


    
![png](output_116_0.png)
    


–°—É–¥—è –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ iPhone, Mac –∏ Android –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, –ø—Ä–∏—á—ë–º –ø–æ—Å—Ç–æ—è–Ω–Ω–æ. –í–æ–∑–º–æ–∂–Ω–æ, –¥–µ–ª–æ –≤ —É–¥–µ—Ä–∂–∞–Ω–∏–∏.


```python
# —Å–º–æ—Ç—Ä–∏–º —É–¥–µ—Ä–∂–∞–Ω–∏–µ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

retention_raw, retention_grouped, retention_history = get_retention(
    profiles, visits, observation_date, horizon_days, dimensions=dimensions
)

plot_retention(retention_grouped, retention_history, horizon_days)
```


    
![png](output_118_0.png)
    


–î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ—á–µ–º—É-—Ç–æ –ø–ª–æ—Ö–æ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è. –î–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É–¥–µ—Ä–∂–∞–Ω–∏–µ 14-–≥–æ –¥–Ω—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ–≥–æ 10-15% –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å.

–°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ø—Ä–∏—á–∏–Ω–∞ –≤ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º–µ. –í–∏–¥–∏—Ç—Å—è —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω—ã–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. 

–í—ã–≤–æ–¥—ã:
- –í —Ü–µ–ª–æ–º, —Ä–µ–∫–ª–∞–º–∞ –±–ª–∏–∑–∫–∞ –∫ –æ–∫—É–ø–µ–º–æ—Å—Ç–∏, –µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ 1 –Ω–æ—è–±—Ä—è 2019 –≥–æ–¥–∞, –∞ –≤ –±–∏–∑–Ω–µ—Å-–ø–ª–∞–Ω–µ –∑–∞–ª–æ–∂–µ–Ω–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –æ–∫—É–ø–∞—Ç—å—Å—è –Ω–µ –ø–æ–∑–¥–Ω–µ–µ —á–µ–º —á–µ—Ä–µ–∑ –¥–≤–µ –Ω–µ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∏ —Ç–æ, —á—Ç–æ –≤ –∞–Ω–∞–ª–∏–∑ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –†–µ–∫–ª–∞–º–∞ –ø–æ—á—Ç–∏ –æ–∫—É–ø–∞–µ—Ç—Å—è –∫ –∫–æ–Ω—Ü—É 2–π –Ω–µ–¥–µ–ª–∏. ROI ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–æ 80%
- –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å –º–æ–≥—É—Ç —Å–Ω–∏–∂–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü—ã Mac –∏ iPhone, —Å—Ç—Ä–∞–Ω–∞ - –°–®–ê. –ù–µ –æ–∫—É–ø–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ LeapBop, FaceBoom, TipTop.

<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚úîÔ∏è –ì—Ä–∞—Ñ–∏–∫–∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ üî•. 
</div>
<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –í –∫–æ–Ω—Ü–µ —à–∞–≥–∞ –Ω–∞–ø–∏—à–∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ –≤—Å–µ–º –≥—Ä–∞—Ñ–∏–∫–∞–º. –ö–æ–Ω–µ—á–Ω–æ–º—É –∑–∞–∫–∞–∑—á–∏–∫—É —Ç–∞–∫ –ø—Ä–æ—â–µ, –Ω–µ –Ω–∞–¥–æ –≤—ã–∏—Å–∫–∏–≤–∞—Ç—å –≤—ã–≤–æ–¥—ã –ø–æ –≤—Å–µ–º—É —à–∞–≥—É.
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚ùå –¢—É—Ç —Ç–∞–∫-–∂–µ –Ω–∞–¥–æ –ø–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥—ã –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ organic.
</div>

### –í—ã–≤–æ–¥—ã

#### –ü—Ä–∏—á–∏–Ω—ã –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ–ª—É—á–µ–Ω—ã –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∫ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã–µ –æ –≤–∏–∑–∏—Ç–∞—Ö, –∑–∞–∫–∞–∑–∞—Ö –∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ç—Ä–∞—Ç–∞—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 –º–∞—è –ø–æ 27 –æ–∫—Ç 2019.
–í—ã–ø–æ–ª–Ω–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º:

**–ü–û –†–ï–ö–õ–ê–ú–ù–´–ú –ö–ê–ù–ê–õ–ê–ú** 
–û–∫–æ–ª–æ 1/3 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—à–ª–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ "–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–≥–æ‚Äù –ø–æ–∏—Å–∫–∞, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—ã–ª–∏ –ø—Ä–∏—Å–ª–µ—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ä–µ–∫–ª–∞–º–Ω–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏:
- FaceBoom (–¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 40%);
- TipTop (–¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 21%) ;
- OppleCreativeMedia;
- LeapBob;
- WahooNetBanner;
- RocketSuperAds;
- MediaTornado;
- YRabbit;
- AdNonSense;
- lambdaMediaAds.    


- –õ–∏–¥–µ—Ä—ã –ø–æ LTV ‚Äî —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Å–µ—Ç–∏ lambdaMediaAds –∏ TipTop. –í –∏—é–Ω–µ LTV 14-–≥–æ –¥–Ω—è —ç—Ç–æ–π —Å–µ—Ç–∏ —Ä–µ–∑–∫–æ –ø–æ–¥—Å–∫–æ—á–∏–ª, –æ–¥–Ω–∞–∫–æ –ø–æ–∑–¥–Ω–µ–µ —Å—Ç–∞–ª –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º.
- –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –æ–∫—É–ø–∞–µ—Ç—Å—è. –õ—É—á—à–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å ROI —É —Ç–∞–∫–∏—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –∫–∞–∫ YRabbit, MediaTornado, lambdaMediaAds, RocketSuperAds –∏ LeapBob. –°–µ—Ç—å YRabbit –æ—Å–æ–±–µ–Ω–Ω–æ –ª–∏–¥–∏—Ä—É–µ—Ç —Å –±–æ–ª—å—à–∏–º –æ—Ç—Ä—ã–≤–æ–º –¥–æ —Å–µ–Ω—Ç—è–±—Ä—è. –ê –≤–æ—Ç —Å–µ—Ç–∏ TipTop, FaceBoom –∏ AdNonSense —Å–æ–≤—Å–µ–º –Ω–µ –æ–∫—É–ø–∞—é—Ç—Å—è.
- –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –Ω–µ–º–Ω–æ–≥–æ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1 (—Å–∞–º–∞—è –Ω–∏–∑–∫–∞—è —É LeapBob, MediaTornado, YRabbit –∏ OppleCreativeMedia). CAC Faceboom —Å—Ç–∞–±–ª–∏–ª—å–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1,1. –ê –≤–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Å–µ—Ç–∏ TipTop ¬´—Å—Ç–æ—è—Ç¬ª –≤ —Ä–∞–∑—ã –¥–æ—Ä–æ–∂–µ –∏ CAC –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π FaceBoom, AdNonSense, lambdaMediaAds –∏ TipTop. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ –≤—Å–µ–º –∫–∞–Ω–∞–ª–∞–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∫—Ä–æ–º–µ "–≤—Å–ø–ª–µ—Å–∫–∞" –≤ –∏—é–Ω–µ –ø–æ lambdaMediaAds. 
- –£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ FaceBoom –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç –ø—Ä–æ—á–∏—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 15%.


*–ü–†–û–ë–õ–ï–ú–ê:
–í –±—É–¥—É—â–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –ø–æ—á–µ–º—É –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å TipTop —Ç–∞–∫–∞—è –Ω–∏–∑–∫–∞—è. –ü–ª–æ—Ö–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ RocketSuperAds, MediaTornado, YRabbit. –£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ FaceBoom –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç –ø—Ä–æ—á–∏—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–µ—Ç–µ–π –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 15%.*


**–ü–û –°–¢–†–ê–ù–ê–ú**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–∑ –°–®–ê (–¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 78%), –Ω–µ–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–∞–∫–∂–µ –∏–∑ - –í–µ–ª–∏–∫–æ–±—Ä–µ—Ç–∞–Ω–∏–∏, –§—Ä–∞–Ω—Ü–∏–∏ –∏ –ì–µ—Ä–º–∞–Ω–∏–∏.
- –†–µ–∫–ª–∞–º–∞ –æ–∫—É–ø–∞–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –∫—Ä–æ–º–µ –°–®–ê, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –æ–∫—É–ø–∞—Ç—å—Å—è —Å –∏—é–ª—è. –õ—É—á—à–µ –≤—Å–µ–≥–æ –æ–∫—É–ø–∞–µ—Ç—Å—è —Ä–µ–∫–ª–∞–º–∞ –≤ –í–µ–ª–∏–∫–æ–±—Ä–µ—Ç–∞–Ω–∏–∏.
- –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω –∫—Ä–æ–º–µ –æ–ø—è—Ç—å –∂–µ –°–®–ê, –≥–¥–µ CAC –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª–∞ –≤—ã—à–µ, —á–µ–º –≤ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –∏ —Å –∫–∞–∂–¥—ã–º –º–µ—Å—è—Ü–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞–ª–∞—Å—å.
- LTV –ø–æ–¥–≤–µ—Ä–∂–µ–Ω —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö.
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è, –ø—Ä–∏—á–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –°–®–ê. 
- –£–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–ª–∞—Ç—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –°–®–ê –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç –ø—Ä–æ—á–∏—Ö —Å—Ç—Ä–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 10%.

*–ü–†–û–ë–õ–ï–ú–ê: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞—Ç–∏—Ç—å –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –°–®–ê, —Ç.–∫.—Ä–µ–∫–ª–∞–º–∞ –≤ –°–®–ê –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –°–®–ê —è–≤–Ω–æ –ø–ª–æ—Ö–æ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.*

**–ü–û –£–°–¢–†–û–ô–°–¢–ê–í–ê–ú**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ PC —Å—Ç–∞–±–∏–ª—å–Ω–æ –æ–∫—É–ø–∞—é—Ç—Å—è, –∞ –≤–æ—Ç –≤–ª–∞–¥–µ–ª—å—Ü—ã iPhone, Mac –∏ Android –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –æ–∫—É–ø–∞—Ç—å—Å—è –Ω–∞—á–∏–Ω–∞—è —Å –∏—é–ª—è.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ iPhone, Mac –∏ Android –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ.
- –î–∏–Ω–∞–º–∏–∫–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ—á–µ–º—É-—Ç–æ –ø–ª–æ—Ö–æ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è. –î–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É–¥–µ—Ä–∂–∞–Ω–∏–µ 14-–≥–æ –¥–Ω—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ–≥–æ 10-15% –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ø—Ä–∏—á–∏–Ω–∞ –≤ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º–µ.  

*–ü–†–û–ë–õ–ï–ú–ê: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞—Ç–∏—Ç—å –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ Mac –∏ iPhone - —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏—Ö –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≤—ã—Å–æ–∫–∞, –∞ –æ–∫—É–ø–∞–µ–º–æc—Ç—å –Ω–∏–∑–∫–∞—è. –¢–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è –ª–∏ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—Å–ª–µ–¥—Å—Ç–≤–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã.*

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–¥–µ–ª–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

- –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º–Ω—É—é —Å–µ—Ç—å TipTop (–±–æ–ª—å—à–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–µ –æ–ø—Ä–∞–≤–¥—ã–≤–∞—é—Ç –æ–∂–∏–¥–∞–∞–Ω–∏—è), –∞ —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–º–æ—Ä—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ YRabbit, MediaTornado, lambdaMediaAds, RocketSuperAds –∏ LeapBob.
- –£—Ä–æ–≤–µ–Ω—å –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã –≤ –°–®–ê –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π, –ø–æ—ç—Ç–æ–º—É –≤–∏–¥–∏—Ç—Å—è —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω—ã–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã (–ê–Ω–≥–ª–∏—é –∏ –ì–µ—Ä–º–∞–Ω–∏—é), –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ –º–æ–≥–ª–æ –ø–æ—Å–ª—É–∂–∏—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –ø–∞–¥–µ–Ω–∏—è –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –≤ –°–®–ê —Å –∏—é–ª—è 2019.
- –ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–ª–∞–¥–µ–ª—å—Ü–∞–º–∏ Mac –∏ iPhone, —Ç.–∫. —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏—Ö –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –≤—ã—Å–æ–∫–∞, –∞ –æ–∫—É–ø–∞–µ–º–æc—Ç—å —Å—Ç—Ä–∞–¥–∞–µ—Ç (–≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–º–µ–Ω–Ω–æ –¥–ª—è –Ω–∏—Ö).

<div class="alert alert-danger">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>
    
  ‚ùå –û–±—â–∏–π –≤—ã–≤–æ–¥ –∑–¥–æ—Ä–æ–≤–æ –Ω–∞—á–∞–ª—Å—è, –Ω–æ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–±–∏–≤–∫–µ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º. –ê —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ—Ç–¥–µ–ª—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –Ω–µ—Ç –≤–æ–æ–±—â–µ.
</div>

<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –í—ã–ø–æ–ª–Ω–µ–Ω–æ.
</div>
<div class="alert alert-warning">
    
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.2</b>
    
  ‚ö†Ô∏è –•–æ—Ä–æ—à–æ. –ú–æ–∂–Ω–æ —á—É—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥: –Ω–µ "—Ä–∞—Å—Å–º–æ—Ä—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–Ω–∞–ª—ã.", –∞ –Ω–∞ –∫–∞–Ω–∞–ª—ã —Ç–∞–∫–∏–µ-—Ç–æ.
</div>
<div class="alert alert-block alert-info">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
    
  –î–æ–±–∞–≤–∏–ª–∞.
</div>
<div class="alert alert-success">
  
  <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v.3</b>
    
  ‚úîÔ∏è –í—ã–≤–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–∏–ª—Å—è, —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ –≤ —á–µ–º –ø—Ä–æ–±–ª–µ–º–∞ –∏ –¥–∞–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –µ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–π.  üëç
</div>

<div style="border:solid black 2px; padding: 20px">
     
  <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫</b>
    
  üìÉ –î–æ–±–∞–≤–∏—Ç—å –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞. 
    
  üìÉ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã\—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞\–∫–∞–Ω–∞–ª–∞.
    
  üìÉ –£–±—Ä–∞—Ç—å –∫–∞–Ω–∞–ª "organic" –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏—á–∏–Ω –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç.
    
  üìÉ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ —à–∞–≥—É –æ—Ü–µ–Ω–∫–∏ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã.
    
  üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—â–∏–π –≤—ã–≤–æ–¥, –¥–æ–±–∞–≤–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç–¥–µ–ª—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.
    
–ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Å—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã. –£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.
</div>

<div style="border:solid black 2px; padding: 20px">
     
  <b>–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏</b>
    
  üìÉ –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ - –í–´–ü–û–õ–ù–ï–ù–û. 
    
  üìÉ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã\—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞\–∫–∞–Ω–∞–ª–∞ - –í–´–ü–û–õ–ù–ï–ù–û.
    
  üìÉ –£–±—Ä–∞—Ç—å –∫–∞–Ω–∞–ª "organic" –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏—á–∏–Ω –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç - –í–´–ü–û–õ–ù–ï–ù–û.
    
  üìÉ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ —à–∞–≥—É –æ—Ü–µ–Ω–∫–∏ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º—ã - –í–´–ü–û–õ–ù–ï–ù–û.
    
  üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—â–∏–π –≤—ã–≤–æ–¥, –¥–æ–±–∞–≤–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç–¥–µ–ª—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ - –í–´–ü–û–õ–ù–ï–ù–û.
    
–ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Å—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã. –£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.
</div>

<div style="border:solid black 2px; padding: 20px">
  
    
  <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫ v.2</b>
    
  üìÉ –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –æ—à–∏–±–∫—É `NameError`.

  üìÉ –ü—Ä–∏–≤–µ—Å—Ç–∏ –≤—ã–≤–æ–¥—ã –ø–æ –∞–Ω–∞–ª–∏–∑—É –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏.
    
 
–ò—Å–ø—Ä–∞–≤–ª—è–π –∏ –ø—Ä–∏—Å—ã–ª–∞–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Ä–µ–≤—å—é.
</div>
